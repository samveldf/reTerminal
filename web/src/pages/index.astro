---
import BaseLayout from '../layouts/BaseLayout.astro';

const rotateSeconds = Number(import.meta.env.PAGE_ROTATE_SECONDS || 20);
const requested = Number(Astro.url.searchParams.get('p') || '1');
const page = requested === 2 || requested === 3 ? requested : 1;
const next = page === 3 ? 1 : page + 1;
---

<BaseLayout>
  <div class="loop-root">
    <iframe src={`/page${page}`} class="page-frame" title="cyber page" loading="eager"></iframe>
  </div>

  <script is:inline define:vars={{ next, rotateSeconds }}>
    const nextPage = next;
    const seconds = rotateSeconds;
    setTimeout(() => {
      window.location.replace(`/?p=${nextPage}`);
    }, seconds * 1000);
  </script>
</BaseLayout>

<style>
  .loop-root,
  .page-frame {
    width: 800px;
    height: 480px;
    margin: 0;
    padding: 0;
    border: 0;
    display: block;
  }
</style>
